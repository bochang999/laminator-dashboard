# Ver.8.6 ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼å ±å‘Šæ›¸

## ğŸš¨ ç™ºç”Ÿã—ãŸã‚¨ãƒ©ãƒ¼

### ã‚¨ãƒ©ãƒ¼æ¦‚è¦
**å ´æ‰€**: android/app/build.gradle line 7  
**ã‚¨ãƒ©ãƒ¼**: `Could not get unknown property 'release' for SigningConfig container`  
**åŸå› **: AWKã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã‚ˆã‚‹signingConfigsã®æ³¨å…¥ã§Gradleæ§‹æ–‡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ

### å…·ä½“çš„ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
```
Build file '/home/runner/work/laminator-dashboard/laminator-dashboard/android/app/build.gradle' line: 7
Could not get unknown property 'release' for SigningConfig container of type org.gradle.api.internal.FactoryNamedDomainObjectContainer.
```

## ğŸ“‹ å®Ÿè¡Œã—ãŸä¿®æ­£å†…å®¹ï¼ˆVer.8.6ï¼‰

### 1. JDK 17â†’21ã¸ã®æ›´æ–° âœ…
```yaml
env:
  JAVA_VERSION: '21'

- name: Setup Java
  uses: actions/setup-java@v4
  with:
    java-version: '21'
```

### 2. Android SDK API 35ã®æ˜ç¤ºã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« âœ…
```yaml
- name: Install Android SDK packages
  run: |
    sdkmanager --install \
      "platforms;android-35" \
      "build-tools;35.0.0" \
      "platform-tools"
```

### 3. SDKãƒ©ã‚¤ã‚»ãƒ³ã‚¹éå¯¾è©±æ‰¿èª âœ…
```yaml
- name: Accept Android licenses (non-interactive)
  run: yes | sdkmanager --licenses
```

### 4. Androidç”Ÿæˆã®é †åºä¸€æœ¬åŒ– âœ…
```yaml
- name: Initialize Capacitor (once only)
  run: |
    rm -rf capacitor.config.* android ios electron
    npx cap init "${{ env.APP_NAME }}" "${{ env.APP_ID }}" --web-dir="www"
    npx cap add android
```

### 5. API 35æœ€å°å¤‰æ›´ âœ…
```yaml
- name: Force API 35 (minimal)
  run: |
    sed -i 's/compileSdkVersion = .*/compileSdkVersion = 35/' android/variables.gradle || true
    sed -i 's/targetSdkVersion = .*/targetSdkVersion = 35/' android/variables.gradle || true
```

### 6. ç½²åå›ºå®šåŒ–ã®å®Ÿè£… âŒ **â†ã‚¨ãƒ©ãƒ¼åŸå› **
```yaml
- name: Inject signing (keystore & gradle)
  run: |
    # keystoreå¾©å…ƒ (æˆåŠŸ)
    echo "${{ secrets.KEYSTORE_B64 }}" | base64 -d > android/app/release.keystore
    
    # gradle.propertiesè¿½è¨˜ (æˆåŠŸ)
    cat >> android/gradle.properties <<'EOF'
MY_STORE_FILE=app/release.keystore
MY_STORE_PASSWORD=${{ secrets.KEYSTORE_PASSWORD }}
MY_KEY_ALIAS=${{ secrets.KEY_ALIAS }}
MY_KEY_PASSWORD=${{ secrets.KEY_PASSWORD }}
EOF
    
    # build.gradleä¿®æ­£ (å¤±æ•— - æ§‹æ–‡ã‚¨ãƒ©ãƒ¼)
    if ! grep -q "signingConfigs" "$FILE"; then
      awk '
        /defaultConfig {/ { 
          print; 
          print "        signingConfig signingConfigs.release"; 
          next 
        }
        /buildTypes {/ { 
          print; 
          print "    signingConfigs {"; 
          print "        release {"; 
          print "            storeFile file(MY_STORE_FILE)"; 
          print "            storePassword MY_STORE_PASSWORD"; 
          print "            keyAlias MY_KEY_ALIAS"; 
          print "            keyPassword MY_KEY_PASSWORD"; 
          print "        }"; 
          print "    }"; 
          next 
        }
        { print }
      ' "$FILE" > "$FILE.tmp" && mv "$FILE.tmp" "$FILE"
    fi
```

## ğŸ” å•é¡Œã®åˆ†æ

### AWKã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å•é¡Œç‚¹
1. **æ§‹æ–‡é †åº**: `signingConfigs`å®šç¾©å‰ã«`signingConfig signingConfigs.release`ã‚’å‚ç…§
2. **Gradleã‚¹ã‚³ãƒ¼ãƒ—**: `defaultConfig`å†…ã§`signingConfigs.release`ãŒæœªå®šç¾©
3. **AWKæŒ¿å…¥ä½ç½®**: æ­£ã—ã„Android Gradleãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®æ§‹é€ ã«åˆè‡´ã—ãªã„

### æ­£å¸¸ãªGradleæ§‹æ–‡
```gradle
android {
    signingConfigs {
        release {
            storeFile file('keystore.jks')
            storePassword 'password'
            keyAlias 'alias'
            keyPassword 'password'
        }
    }
    
    defaultConfig {
        signingConfig signingConfigs.release
    }
    
    buildTypes {
        release {
            signingConfig signingConfigs.release
        }
    }
}
```

## ğŸ“ ç¾åœ¨ã®çŠ¶æ³

### æˆåŠŸã—ãŸéƒ¨åˆ†
- JDK 21è¨­å®š: `JAVA_HOME: /opt/hostedtoolcache/Java_Temurin-Hotspot_jdk/21.0.8-9/x64`
- Android SDK API 35ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«: æ­£å¸¸å®Œäº†
- ãƒ©ã‚¤ã‚»ãƒ³ã‚¹æ‰¿èª: éå¯¾è©±ã§æˆåŠŸ
- CapacitoråˆæœŸåŒ–: android/gradlewæ­£å¸¸ä½œæˆ
- ã‚­ãƒ¼ã‚¹ãƒˆã‚¢å¾©å…ƒ: android/app/release.keystoreä½œæˆæˆåŠŸ
- gradle.propertiesè¨­å®š: MY_STORE_FILEç­‰ã®è¨­å®šæˆåŠŸ

### å¤±æ•—ã—ãŸéƒ¨åˆ†
- **build.gradleç½²åè¨­å®šæ³¨å…¥**: AWKã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã‚ˆã‚‹æ§‹æ–‡ã‚¨ãƒ©ãƒ¼

## ğŸ¯ è§£æ±ºãŒå¿…è¦ãªèª²é¡Œ

1. **AWKã‚¹ã‚¯ãƒªãƒ—ãƒˆä¿®æ­£**: æ­£ã—ã„Gradleæ§‹æ–‡ã§ã®ç½²åè¨­å®šæ³¨å…¥
2. **æ§‹æ–‡é †åº**: signingConfigså®šç¾©â†’å‚ç…§ã®é †åºç¢ºä¿
3. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: AWKå¤±æ•—æ™‚ã®ä»£æ›¿æ‰‹æ³•

## ğŸ“Š ãƒ­ã‚°è©³ç´°

### ç’°å¢ƒæƒ…å ±
```
NODE_VERSION: 20
JAVA_VERSION: 21
JAVA_HOME: /opt/hostedtoolcache/Java_Temurin-Hotspot_jdk/21.0.8-9/x64
ANDROID_HOME: /usr/local/lib/android/sdk
VERSION_TAG: 8.4.96
SIGNING_MODE: bootstrap-temporary
```

### Gradleæƒ…å ±
```
Gradle 8.11.1
Android Gradle Plugin: (Capacitorãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ)
Build Tools: 35.0.0
```

## ğŸ› ï¸ æ¬¡å›ä¿®æ­£æ–¹é‡

1. **AWKã‚¹ã‚¯ãƒªãƒ—ãƒˆæ”¹è‰¯**: æ­£ç¢ºãªGradleæ§‹æ–‡ç”Ÿæˆ
2. **ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ–¹å¼**: äº‹å‰å®šç¾©ã•ã‚ŒãŸbuild.gradleå·®ã—æ›¿ãˆ
3. **Gradle Propertiesæ–¹å¼**: signingConfigsã‚’ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£çµŒç”±ã§è¨­å®š
4. **æ®µéšçš„æ¤œè¨¼**: å„ã‚¹ãƒ†ãƒƒãƒ—ã§ã®æ§‹æ–‡ãƒã‚§ãƒƒã‚¯

ã“ã®ã‚¨ãƒ©ãƒ¼ã¯ç½²åå›ºå®šåŒ–ã®å®Ÿè£…éƒ¨åˆ†ã®ã¿ãŒå•é¡Œã§ã€ä»–ã®ä¿®æ­£ï¼ˆJDK21ã€SDK35ã€Androidç”Ÿæˆä¸€æœ¬åŒ–ç­‰ï¼‰ã¯å…¨ã¦æ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã‚‹ã€‚